!function(A,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(A=A||self).FilePondPluginImageExifOrientation=e()}(this,function(){"use strict";var A=function(A,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return A.getUint16(e,n)},e=function(A,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return A.getUint32(e,n)},n=void 0,t="undefined"!=typeof window&&void 0!==window.document?new Image:{};t.onload=function(){return n=t.naturalWidth>t.naturalHeight},t.src="data:image/jpg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/4QA6RXhpZgAATU0AKgAAAAgAAwESAAMAAAABAAYAAAEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAD/2wBDAP//////////////////////////////////////////////////////////////////////////////////////wAALCAABAAIBASIA/8QAJgABAAAAAAAAAAAAAAAAAAAAAxABAAAAAAAAAAAAAAAAAAAAAP/aAAgBAQAAPwBH/9k=";var i=function(t){var i=t.addFilter,o=t.utils,r=o.Type,a=o.isFile;return i("DID_LOAD_ITEM",function(t,i){var o=i.query;return new Promise(function(i,r){var d=t.file;if(!(a(d)&&/^image\/jpeg/.test(d.type)&&o("GET_ALLOW_IMAGE_EXIF_ORIENTATION")&&n))return i(t);(function(n){return new Promise(function(t,i){var o=new FileReader;o.onload=function(n){var i=new DataView(n.target.result);if(65496===A(i,0)){for(var o=i.byteLength,r=2;r<o;){var a=A(i,r);if(r+=2,65505===a){if(1165519206!==e(i,r+=2))break;var d=18761===A(i,r+=6);r+=e(i,r+4,d);var u=A(i,r,d);r+=2;for(var f=0;f<u;f++)if(274===A(i,r+12*f,d))return void t(A(i,r+12*f+8,d))}else{if(65280!=(65280&a))break;r+=A(i,r)}}t(-1)}else t(-1)},o.readAsArrayBuffer(n.slice(0,65536))})})(d).then(function(A){t.setMetadata("exif",{orientation:A}),i(t)})})}),{options:{allowImageExifOrientation:[!0,r.BOOLEAN]}}};return"undefined"!=typeof window&&void 0!==window.document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:i})),i});